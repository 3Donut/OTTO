<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- For Mobile Devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
    <meta name="generator" content="Doxygen 1.8.17" />
    <script type="text/javascript" src="jquery-2.1.1.min.js"></script>
    <title>OTTO: /home/travis/build/topisani/OTTO/src/util/dsp/BiquadSoftReset.hpp Source File</title>
    <!--<link href="tabs.css" rel="stylesheet" type="text/css"/>-->
    <script type="text/javascript" src="jquery.powertip.min.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
      <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>
    <link href='https://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="bootstrap.min.css">
    <script type="text/javascript" src="bootstrap.min.js"></script>
    <script type="text/javascript" src="doxy-boot.js"></script>
    <link rel="stylesheet" href="jquery.powertip.css">
    <link rel="stylesheet" href="website-styles.css" />
    <link href="doxygen.css" rel="stylesheet" type="text/css" /> <link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
    <nav class="navbar navbar-fixed-top" role="navigation">
        <div class="container">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
                     <span class="icon-bar"></span>
                     <span class="icon-bar"></span>
                     <span class="icon-bar"></span>
                 </button>
            <a href="." class="navbar-brand">OTTO </a>
            <nav class="collapse navbar-collapse navbar-responsive-collapse">
                <ul class="nav navbar-nav pull-right">
                            <li><a href="index.html">Overview</a></li>
                            <li><a href="annotated.html">Class&nbsp;List</a></li>
                            <li><a href="classes.html">Class&nbsp;Index</a></li>
                            <li><a href="hierarchy.html">Class&nbsp;Hierarchy</a></li>
                            <li><a href="functions.html">Class&nbsp;Members</a></li>
                </ul>
            </nav>
        </div>
    </nav>
    <!-- nav class="navbar navbar-default" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand">OTTO ..</a>
        </div>
        </div>
        </nav -->
    <div id="top">
        <!-- do not remove this div, it is closed by doxygen! -->
        <div class="content" id="content">
            <div class="container">
                <div class="row">
                    <div class="col-sm-12 panel " style="padding-bottom: 15px;">
                        <div style="margin-bottom: 15px;">
                            <!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_b7878ad5ecbf2506f4125b9d34c97e45.html">util</a></li><li class="navelem"><a class="el" href="dir_ba415044076d8fd14797c16d08b6c161.html">dsp</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">BiquadSoftReset.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_biquad_soft_reset_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;Gamma/ipl.h&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &quot;Gamma/scl.h&quot;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &quot;Gamma/Containers.h&quot;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;Gamma/Domain.h&quot;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;Gamma/Types.h&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;Gamma/Filter.h&quot;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160; </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T=gam::real, <span class="keyword">class</span> Td=gam::DomainObserver&gt;</div>
<div class="line"><a name="l00009"></a><span class="lineno"><a class="line" href="class_pan_from_constant.html">    9</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_pan_from_constant.html">PanFromConstant</a> : <span class="keyword">public</span> Td{</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00011"></a><span class="lineno"><a class="line" href="class_pan_from_constant.html#aaad1408a3a0ff9af99dbfc12726488fe">   11</a></span>&#160;    <a class="code" href="class_pan_from_constant.html#aaad1408a3a0ff9af99dbfc12726488fe">PanFromConstant</a>(T tau){</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;      pan.period(tau);</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    };</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno"><a class="line" href="class_pan_from_constant.html#a0d55afe01cfbb439fca3a1c5c5bee7e8">   15</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_pan_from_constant.html#a0d55afe01cfbb439fca3a1c5c5bee7e8">period</a>(T tau){</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;      pan.period(tau);</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    }</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="class_pan_from_constant.html#ab54c634cc91144393e742cc8852fe7a9">   19</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_pan_from_constant.html#ab54c634cc91144393e742cc8852fe7a9">operator=</a>(T new_cst){</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;      cst = new_cst;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;      pan.reset();</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    };</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="class_pan_from_constant.html#a4e6daa218e60a98508c4594e09e9800c">   24</a></span>&#160;    T <a class="code" href="class_pan_from_constant.html#a4e6daa218e60a98508c4594e09e9800c">operator()</a>(T in){</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;      T val = pan();</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;      <span class="keywordflow">return</span> cst * val + in * (1 - val);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    };</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    T cst = T(0);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    gam::SegExp&lt;T, Td&gt; pan{0.1};</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;};</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Tv=gam::real, <span class="keyword">class</span> Tp=gam::real, <span class="keyword">class</span> Td=gam::DomainObserver&gt;</div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html">   51</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_biquad_soft_reset.html" title="2-pole/2-zero IIR filter with soft reset">BiquadSoftReset</a> : <span class="keyword">public</span> Td{</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="class_biquad_soft_reset.html#ac2ae04b7422a5b2262f5afa99ed0aeea">BiquadSoftReset</a>(Tp frq = Tp(1000), Tp <a class="code" href="class_biquad_soft_reset.html#a01709aa304106dc25646a9d51c07a7ce" title="Get resonance (Q)">res</a> = Tp(0.707), gam::FilterType <a class="code" href="class_biquad_soft_reset.html#ae23cb9ba3bf0f7ec82242903d2c1bb80" title="Get filter type.">type</a> = gam::LOW_PASS);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#a7e12241265687cc3af31ec38374177dc">   61</a></span>&#160;    Tp * <a class="code" href="class_biquad_soft_reset.html#a7e12241265687cc3af31ec38374177dc" title="Get array of 3 feedforward coefficients.">a</a>(){ <span class="keywordflow">return</span> <a class="code" href="class_biquad_soft_reset.html#a83e1cf3860843a0f3cfcac8d3c047003">mA</a>; }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#abf51e5152f52b7c78e1233f93a3e7ba7">   64</a></span>&#160;    Tp * <a class="code" href="class_biquad_soft_reset.html#abf51e5152f52b7c78e1233f93a3e7ba7" title="Get array of 3 feedback coefficients (first element, b0, is not used)">b</a>(){ <span class="keywordflow">return</span> <a class="code" href="class_biquad_soft_reset.html#afccdc71f48d03ef11cc918cb81ca4fe1">mB</a>; }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#aedbd476a3c1901b9230eaa39dbe52811">   66</a></span>&#160;    <span class="keyword">const</span> Tp * <a class="code" href="class_biquad_soft_reset.html#aedbd476a3c1901b9230eaa39dbe52811">a</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="class_biquad_soft_reset.html#a83e1cf3860843a0f3cfcac8d3c047003">mA</a>; }</div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#a191bff54bf40cd788bd9c4a7ed7b305f">   67</a></span>&#160;    <span class="keyword">const</span> Tp * <a class="code" href="class_biquad_soft_reset.html#a191bff54bf40cd788bd9c4a7ed7b305f">b</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="class_biquad_soft_reset.html#afccdc71f48d03ef11cc918cb81ca4fe1">mB</a>; }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_biquad_soft_reset.html#a2f6fe95d3cbe59e9afd5d84160e38d62" title="Set feedforward (a) and feedback (b) coefficients directly.">coef</a>(Tp a0, Tp a1, Tp a2, Tp b1, Tp b2);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_biquad_soft_reset.html#a60dca5cd13c3a1a63b850bd743814bf4" title="Get center frequency.">freq</a>(Tp v);                    </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_biquad_soft_reset.html#a01709aa304106dc25646a9d51c07a7ce" title="Get resonance (Q)">res</a>(Tp v);                     </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_biquad_soft_reset.html#a06d992a0cb01b7fb2bee16cb93ef8d13" title="Get level.">level</a>(Tp v);                   </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_biquad_soft_reset.html#afe080c3a3c438d044426f3ef3f3609c6" title="Set filter center frequency and resonance.">set</a>(Tp frq, Tp <a class="code" href="class_biquad_soft_reset.html#a01709aa304106dc25646a9d51c07a7ce" title="Get resonance (Q)">res</a>);           </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_biquad_soft_reset.html#afe080c3a3c438d044426f3ef3f3609c6" title="Set filter center frequency and resonance.">set</a>(Tp frq, Tp <a class="code" href="class_biquad_soft_reset.html#a01709aa304106dc25646a9d51c07a7ce" title="Get resonance (Q)">res</a>, gam::FilterType <a class="code" href="class_biquad_soft_reset.html#ae23cb9ba3bf0f7ec82242903d2c1bb80" title="Get filter type.">type</a>); </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_biquad_soft_reset.html#ae23cb9ba3bf0f7ec82242903d2c1bb80" title="Get filter type.">type</a>(gam::FilterType <a class="code" href="class_biquad_soft_reset.html#ae23cb9ba3bf0f7ec82242903d2c1bb80" title="Get filter type.">type</a>);            </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_biquad_soft_reset.html#ab870b11ca5a34f774642503ded8474e4" title="Zero internal delays. Softly.">zero</a>();                        </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_biquad_soft_reset.html#a2a5bf7290af15dd7182166ec35ab6c00" title="Manual smoothing of the output.">smoothOutput</a>();    </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_biquad_soft_reset.html#af8d76d7ad0dc9272017b448c0dddc377" title="Set smoothing time.">smoothTime</a>(Tp time); </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    Tv <a class="code" href="class_biquad_soft_reset.html#a82e3ddeeb8872fcd90085d9b94024cf4" title="Filter next sample.">operator()</a>(Tv in);               </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    Tv <a class="code" href="class_biquad_soft_reset.html#afbe41185735ebe0a4502f5b71e4116f0" title="Optimized for band-pass types.">nextBP</a>(Tv in);                   </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    Tp <a class="code" href="class_biquad_soft_reset.html#a60dca5cd13c3a1a63b850bd743814bf4" title="Get center frequency.">freq</a>() <span class="keyword">const</span>;                    </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    Tp <a class="code" href="class_biquad_soft_reset.html#a01709aa304106dc25646a9d51c07a7ce" title="Get resonance (Q)">res</a>() <span class="keyword">const</span>;                     </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    Tp <a class="code" href="class_biquad_soft_reset.html#a06d992a0cb01b7fb2bee16cb93ef8d13" title="Get level.">level</a>() <span class="keyword">const</span>;                   </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    gam::FilterType <a class="code" href="class_biquad_soft_reset.html#ae23cb9ba3bf0f7ec82242903d2c1bb80" title="Get filter type.">type</a>() <span class="keyword">const</span>;           </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_biquad_soft_reset.html#a120880d49e3187ac3c0711faca0daa43">onDomainChange</a>(<span class="keywordtype">double</span> r);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#a83e1cf3860843a0f3cfcac8d3c047003">   94</a></span>&#160;    Tp <a class="code" href="class_biquad_soft_reset.html#a83e1cf3860843a0f3cfcac8d3c047003">mA</a>[3];           <span class="comment">// feedforward coefs</span></div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#afccdc71f48d03ef11cc918cb81ca4fe1">   95</a></span>&#160;    Tp <a class="code" href="class_biquad_soft_reset.html#afccdc71f48d03ef11cc918cb81ca4fe1">mB</a>[3];           <span class="comment">// feedback coefs (first element used to scale coefs)</span></div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#a527c3d11702e2a631f3a8d548e11264e">   96</a></span>&#160;    Tv <a class="code" href="class_biquad_soft_reset.html#aa7bc20bcaae1f5b05cd6c5c66bfb4205">d1</a>, <a class="code" href="class_biquad_soft_reset.html#a527c3d11702e2a631f3a8d548e11264e">d2</a>;          <span class="comment">// inner sample delays</span></div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#afb7cee488fa7cb515665bb199e949f13">   97</a></span>&#160;    Tp <a class="code" href="class_biquad_soft_reset.html#afad3faf680b5efe57f67af3de06646fd">mFreq</a>, <a class="code" href="class_biquad_soft_reset.html#afb7cee488fa7cb515665bb199e949f13">mResRecip</a>;<span class="comment">// center frequency, 1/resonance</span></div>
<div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#a0d68f8e6c584e9686a1a789c9be754b1">   98</a></span>&#160;    Tp <a class="code" href="class_biquad_soft_reset.html#a0d68f8e6c584e9686a1a789c9be754b1">mLevel</a>;          <span class="comment">// amplitude level (for peaking)</span></div>
<div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#aa880e6f6ad627029e36f251f812730e3">   99</a></span>&#160;    gam::FilterType <a class="code" href="class_biquad_soft_reset.html#aa880e6f6ad627029e36f251f812730e3">mType</a>;</div>
<div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#ae4a4bb63f76d504aae26e9f1ae6b9f4c">  100</a></span>&#160;    Tp <a class="code" href="class_biquad_soft_reset.html#ae4a4bb63f76d504aae26e9f1ae6b9f4c">mReal</a>, <a class="code" href="class_biquad_soft_reset.html#a9463ac9820534db0955d5ff182aee61b">mImag</a>;    <span class="comment">// real, imag components of center frequency</span></div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#a3dbe145b3515661ea402ec88b4a6625a">  101</a></span>&#160;    Tp <a class="code" href="class_biquad_soft_reset.html#ab7cc48cfe30755a7490939c40909b1bc">mAlpha</a>, <a class="code" href="class_biquad_soft_reset.html#a3dbe145b3515661ea402ec88b4a6625a">mBeta</a>;</div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#abcee4ed328621a9c81715d6346365080">  102</a></span>&#160;    Tp <a class="code" href="class_biquad_soft_reset.html#abcee4ed328621a9c81715d6346365080">mFrqToRad</a>;</div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#ae35d87d4acd231db0a3b620aed04b6a2">  103</a></span>&#160;    Tv <a class="code" href="class_biquad_soft_reset.html#ae35d87d4acd231db0a3b620aed04b6a2">o0</a> = 0;</div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#a3b1c7d432dff9768d9bfa8961ffe66df">  104</a></span>&#160;    <a class="code" href="class_pan_from_constant.html">PanFromConstant&lt;Tv, Td&gt;</a> <a class="code" href="class_biquad_soft_reset.html#a3b1c7d432dff9768d9bfa8961ffe66df">smooth</a>{0.004};</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_biquad_soft_reset.html#a965fb86eeec0668332d24948bea4bf43">resRecip</a>(Tp v);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;};</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">// Implementation_______________________________________________________________</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Tv, <span class="keyword">class</span> Tp, <span class="keyword">class</span> Td&gt;</div>
<div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#ac2ae04b7422a5b2262f5afa99ed0aeea">  113</a></span>&#160;<a class="code" href="class_biquad_soft_reset.html#ac2ae04b7422a5b2262f5afa99ed0aeea">BiquadSoftReset&lt;Tv,Tp,Td&gt;::BiquadSoftReset</a>(Tp frq, Tp res, gam::FilterType type)</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        :   d1(0), d2(0), mLevel(1), mBeta(1)</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;{</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <a class="code" href="class_biquad_soft_reset.html#a120880d49e3187ac3c0711faca0daa43">onDomainChange</a>(1);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <a class="code" href="class_biquad_soft_reset.html#afe080c3a3c438d044426f3ef3f3609c6" title="Set filter center frequency and resonance.">set</a>(frq, <a class="code" href="class_biquad_soft_reset.html#a01709aa304106dc25646a9d51c07a7ce" title="Get resonance (Q)">res</a>, <a class="code" href="class_biquad_soft_reset.html#ae23cb9ba3bf0f7ec82242903d2c1bb80" title="Get filter type.">type</a>);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;}</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Tv, <span class="keyword">class</span> Tp, <span class="keyword">class</span> Td&gt;</div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#a120880d49e3187ac3c0711faca0daa43">  121</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_biquad_soft_reset.html#a120880d49e3187ac3c0711faca0daa43">BiquadSoftReset&lt;Tv,Tp,Td&gt;::onDomainChange</a>(<span class="keywordtype">double</span> <span class="comment">/*r*/</span>){</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  mFrqToRad = M_2PI * Td::ups();</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  freq(mFreq);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;}</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Tv, <span class="keyword">class</span> Tp, <span class="keyword">class</span> Td&gt;</div>
<div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#a60dca5cd13c3a1a63b850bd743814bf4">  127</a></span>&#160;Tp <a class="code" href="class_biquad_soft_reset.html#a60dca5cd13c3a1a63b850bd743814bf4" title="Get center frequency.">BiquadSoftReset&lt;Tv,Tp,Td&gt;::freq</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> mFreq; }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Tv, <span class="keyword">class</span> Tp, <span class="keyword">class</span> Td&gt;</div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#a01709aa304106dc25646a9d51c07a7ce">  130</a></span>&#160;Tp <a class="code" href="class_biquad_soft_reset.html#a01709aa304106dc25646a9d51c07a7ce" title="Get resonance (Q)">BiquadSoftReset&lt;Tv,Tp,Td&gt;::res</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Tp(0.5)/mResRecip; }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Tv, <span class="keyword">class</span> Tp, <span class="keyword">class</span> Td&gt;</div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#a06d992a0cb01b7fb2bee16cb93ef8d13">  133</a></span>&#160;Tp <a class="code" href="class_biquad_soft_reset.html#a06d992a0cb01b7fb2bee16cb93ef8d13" title="Get level.">BiquadSoftReset&lt;Tv,Tp,Td&gt;::level</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> mLevel; }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Tv, <span class="keyword">class</span> Tp, <span class="keyword">class</span> Td&gt;</div>
<div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#ae23cb9ba3bf0f7ec82242903d2c1bb80">  136</a></span>&#160;gam::FilterType <a class="code" href="class_biquad_soft_reset.html#ae23cb9ba3bf0f7ec82242903d2c1bb80" title="Get filter type.">BiquadSoftReset&lt;Tv,Tp,Td&gt;::type</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> mType; }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Tv, <span class="keyword">class</span> Tp, <span class="keyword">class</span> Td&gt;</div>
<div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#a40228b19900e259458eb0b44ae00bb52">  139</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_biquad_soft_reset.html#afe080c3a3c438d044426f3ef3f3609c6" title="Set filter center frequency and resonance.">BiquadSoftReset&lt;Tv,Tp,Td&gt;::set</a>(Tp freq_, Tp res_, gam::FilterType type_){</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  mType = type_;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  res(res_);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  freq(freq_);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;}</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Tv, <span class="keyword">class</span> Tp, <span class="keyword">class</span> Td&gt;</div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#afe080c3a3c438d044426f3ef3f3609c6">  146</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="class_biquad_soft_reset.html#afe080c3a3c438d044426f3ef3f3609c6" title="Set filter center frequency and resonance.">BiquadSoftReset&lt;Tv,Tp,Td&gt;::set</a>(Tp frq, Tp res){ set(frq, res, mType); }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Tv, <span class="keyword">class</span> Tp, <span class="keyword">class</span> Td&gt;</div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#ab870b11ca5a34f774642503ded8474e4">  149</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_biquad_soft_reset.html#ab870b11ca5a34f774642503ded8474e4" title="Zero internal delays. Softly.">BiquadSoftReset&lt;Tv,Tp,Td&gt;::zero</a>(){</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  d1=d2=Tv(0);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  smooth = o0;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;}</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Tv, <span class="keyword">class</span> Tp, <span class="keyword">class</span> Td&gt;</div>
<div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#a2a5bf7290af15dd7182166ec35ab6c00">  155</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_biquad_soft_reset.html#a2a5bf7290af15dd7182166ec35ab6c00" title="Manual smoothing of the output.">BiquadSoftReset&lt;Tv,Tp,Td&gt;::smoothOutput</a>(){</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  smooth = o0;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;}</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Tv, <span class="keyword">class</span> Tp, <span class="keyword">class</span> Td&gt;</div>
<div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#af8d76d7ad0dc9272017b448c0dddc377">  160</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_biquad_soft_reset.html#af8d76d7ad0dc9272017b448c0dddc377" title="Set smoothing time.">BiquadSoftReset&lt;Tv,Tp,Td&gt;::smoothTime</a>(Tp time){</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  smooth.period(time);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;}</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Tv, <span class="keyword">class</span> Tp, <span class="keyword">class</span> Td&gt;</div>
<div class="line"><a name="l00165"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#a2f6fe95d3cbe59e9afd5d84160e38d62">  165</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_biquad_soft_reset.html#a2f6fe95d3cbe59e9afd5d84160e38d62" title="Set feedforward (a) and feedback (b) coefficients directly.">BiquadSoftReset&lt;Tv,Tp,Td&gt;::coef</a>(Tp a0, Tp a1, Tp a2, Tp b1, Tp b2){</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  mA[0]=a0; mA[1]=a1; mA[2]=a2; mB[1]=b1; mB[2]=b2;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;}</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Tv, <span class="keyword">class</span> Tp, <span class="keyword">class</span> Td&gt;</div>
<div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#a6454331efb1b0ca83cce32c1f6779dce">  170</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="class_biquad_soft_reset.html#a60dca5cd13c3a1a63b850bd743814bf4" title="Get center frequency.">BiquadSoftReset&lt;Tv,Tp,Td&gt;::freq</a>(Tp v){</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  mFreq = v;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  Tp w = gam::scl::clip(mFreq * mFrqToRad, Tp(3.13));</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  mReal = gam::scl::cosT8(w);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  mImag = gam::scl::sinT7(w);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  resRecip(mResRecip);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;}</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Tv, <span class="keyword">class</span> Tp, <span class="keyword">class</span> Td&gt;</div>
<div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#a8c2971c7ddee8dd5d2f869b04e1da547">  179</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="class_biquad_soft_reset.html#a06d992a0cb01b7fb2bee16cb93ef8d13" title="Get level.">BiquadSoftReset&lt;Tv,Tp,Td&gt;::level</a>(Tp v){</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  mLevel=v;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keywordflow">switch</span>(mType){</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">case</span> gam::PEAKING:</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      mBeta = Tp(1)/mLevel;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">case</span> gam::LOW_SHELF:</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordflow">case</span> gam::HIGH_SHELF:</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      mBeta = Tp(2)*<a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/pow.html">std::pow</a>(mLevel, Tp(0.25));</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      mBeta = Tp(1);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  resRecip(mResRecip);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;}</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Tv, <span class="keyword">class</span> Tp, <span class="keyword">class</span> Td&gt;</div>
<div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#a965fb86eeec0668332d24948bea4bf43">  196</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="class_biquad_soft_reset.html#a965fb86eeec0668332d24948bea4bf43">BiquadSoftReset&lt;Tv,Tp,Td&gt;::resRecip</a>(Tp v){</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  mResRecip = v;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  mAlpha = mImag * mResRecip * mBeta;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="keywordflow">switch</span>(mType){</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordflow">case</span> gam::LOW_SHELF: <span class="keywordflow">case</span> gam::HIGH_SHELF: <span class="keywordflow">break</span>; <span class="comment">// coefs computed in type()</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="comment">// Note: b_0 is assumed to be equal to 1 in the difference equation.</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="comment">// For this reason, we divide all other coefficients by b_0.</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      mB[0] = Tp(1) / (Tp(1) + mAlpha); <span class="comment">// 1/b_0</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      mB[1] = Tp(-2) * mReal * mB[0];</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      mB[2] = (Tp(1) - mAlpha) * mB[0];</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  type(mType);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;}</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Tv, <span class="keyword">class</span> Tp, <span class="keyword">class</span> Td&gt;</div>
<div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#a1d52428b5e26217e7827e08cb38fe547">  214</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="class_biquad_soft_reset.html#a01709aa304106dc25646a9d51c07a7ce" title="Get resonance (Q)">BiquadSoftReset&lt;Tv,Tp,Td&gt;::res</a>(Tp v){</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  resRecip(Tp(0.5)/v);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;}</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Tv, <span class="keyword">class</span> Tp, <span class="keyword">class</span> Td&gt;</div>
<div class="line"><a name="l00219"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#ab992dfa710d48066275633bafd1b664f">  219</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="class_biquad_soft_reset.html#ae23cb9ba3bf0f7ec82242903d2c1bb80" title="Get filter type.">BiquadSoftReset&lt;Tv,Tp,Td&gt;::type</a>(gam::FilterType typeA){</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  mType = typeA;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keywordflow">switch</span>(mType){</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">case</span> gam::LOW_PASS:</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      mA[1] = (Tp(1) - mReal) * mB[0];</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      mA[0] = mA[1] * Tp(0.5);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      mA[2] = mA[0];</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">case</span> gam::HIGH_PASS: <span class="comment">// low-pass with odd k a_k and freq flipped</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      mA[1] = (Tp(-1) - mReal) * mB[0];</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      mA[0] = mA[1] * Tp(-0.5);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      mA[2] = mA[0];</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">case</span> gam::RESONANT:</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      mA[0] = mImag * Tp(0.5) * mB[0];</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      mA[1] = Tp(0);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      mA[2] =-mA[0];</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">case</span> gam::BAND_PASS:</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      mA[0] = mAlpha * mB[0];</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      mA[1] = Tp(0);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      mA[2] =-mA[0];</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">case</span> gam::BAND_REJECT:</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      mA[0] = mB[0];</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      mA[1] = mB[1];</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      mA[2] = mB[0];</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordflow">case</span> gam::ALL_PASS:</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      mA[0] = mB[2];</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      mA[1] = mB[1];</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      mA[2] = Tp(1);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">case</span> gam::PEAKING:{</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      Tp alpha_A_b0 = mAlpha * mLevel * mB[0];</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      mA[0] = mB[0] + alpha_A_b0;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      mA[1] = mB[1];</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      mA[2] = mB[0] - alpha_A_b0;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordflow">case</span> gam::LOW_SHELF:{</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      Tp A = mBeta*mBeta*Tp(0.25); <span class="comment">// sqrt(mLevel)</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      Tp Ap1 = A + Tp(1), Am1 = A - Tp(1);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      mB[0] =    Tp(1)/(Ap1 + Am1*mReal + mAlpha); <span class="comment">// 1/b_0</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      mB[1] =   Tp(-2)*(Am1 + Ap1*mReal         ) * mB[0];</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      mB[2] =          (Ap1 + Am1*mReal - mAlpha) * mB[0];</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      mA[0] =        A*(Ap1 - Am1*mReal + mAlpha) * mB[0];</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      mA[1] = Tp( 2)*A*(Am1 - Ap1*mReal         ) * mB[0];</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      mA[2] =        A*(Ap1 - Am1*mReal - mAlpha) * mB[0];</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">case</span> gam::HIGH_SHELF:{</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      Tp A = mBeta*mBeta*Tp(0.25); <span class="comment">// sqrt(mLevel)</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      Tp Ap1 = A + Tp(1), Am1 = A - Tp(1);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      mB[0] =   Tp(1)/(Ap1 - Am1*mReal + mAlpha); <span class="comment">// 1/b_0</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      mB[1] =   Tp(2)*(Am1 - Ap1*mReal         ) * mB[0];</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      mB[2] =         (Ap1 - Am1*mReal - mAlpha) * mB[0];</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      mA[0] =       A*(Ap1 + Am1*mReal + mAlpha) * mB[0];</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      mA[1] =Tp(-2)*A*(Am1 + Ap1*mReal         ) * mB[0];</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      mA[2] =       A*(Ap1 + Am1*mReal - mAlpha) * mB[0];</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">default</span>:;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  };</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;}</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Tv, <span class="keyword">class</span> Tp, <span class="keyword">class</span> Td&gt;</div>
<div class="line"><a name="l00287"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#a82e3ddeeb8872fcd90085d9b94024cf4">  287</a></span>&#160;<span class="keyword">inline</span> Tv <a class="code" href="class_biquad_soft_reset.html#a82e3ddeeb8872fcd90085d9b94024cf4" title="Filter next sample.">BiquadSoftReset&lt;Tv,Tp,Td&gt;::operator()</a>(Tv i0){</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="comment">// Direct form II</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  i0 = i0 - d1*mB[1] - d2*mB[2];</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  o0 = i0*mA[0] + d1*mA[1] + d2*mA[2];</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  d2 = d1; d1 = i0;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="keywordflow">return</span> smooth(o0);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;}</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Tv, <span class="keyword">class</span> Tp, <span class="keyword">class</span> Td&gt;</div>
<div class="line"><a name="l00296"></a><span class="lineno"><a class="line" href="class_biquad_soft_reset.html#afbe41185735ebe0a4502f5b71e4116f0">  296</a></span>&#160;<span class="keyword">inline</span> Tv <a class="code" href="class_biquad_soft_reset.html#afbe41185735ebe0a4502f5b71e4116f0" title="Optimized for band-pass types.">BiquadSoftReset&lt;Tv,Tp,Td&gt;::nextBP</a>(Tv i0){</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  i0 = i0 - d1*mB[1] - d2*mB[2];</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  o0 = (i0 - d2)*mA[0];</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  d2 = d1; d1 = i0;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordflow">return</span> smooth(o0);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<address class="footer">
  <small>Version: ..  | Generated by <a href="http://www.doxygen.org/index.html"> Doxygen 1.8.17</a></small>
</address>
</body>
</html>
